// Copyright (c) 2024 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@v0.1.0-esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@v0.1.0-esm/index.mjs";import{primitives as r}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer-array@v0.1.0-esm/index.mjs";import{isPrimitive as s}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer@v0.1.0-esm/index.mjs";import{primitives as n}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer-array@v0.1.0-esm/index.mjs";import i from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@v0.1.1-esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-order@v0.1.1-esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-data-type@v0.1.0-esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-buffer-length-compatible@v0.1.0-esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-numel@v0.1.1-esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ctor@v0.1.0-esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-defaults@v0.1.1-esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-inherit@v0.1.1-esm/index.mjs";import g from"https://cdn.jsdelivr.net/gh/stdlib-js/string-format@v0.1.1-esm/index.mjs";import{isPrimitive as p}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer@v0.1.0-esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ind@v0.1.1-esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@v0.1.0-esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@v0.1.1-esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-array@v0.1.1-esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-index-mode@v0.1.1-esm/index.mjs";import{isPrimitive as y}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@v0.1.1-esm/index.mjs";var w=l.prototype.iget;var _=l.prototype.iset;function E(e,t){var r,s;for(r=[],s=0;s<t;s++)r.push(e[s]);return r}function x(e,t){var r;if(!b(t))return new TypeError(g("invalid argument. Options argument must be an object. Value: `%s`.",t));if(v(t,"mode")&&(e.mode=t.mode,!j(e.mode)))return new TypeError(g("invalid option. `%s` option must be a recognized mode. Option: `%s`.","mode",e.mode));if(v(t,"submode")){if(e.submode=t.submode,!c(e.submode))return new TypeError(g("invalid option. `%s` option must be an array containing recognized modes. Option: `%s`.","submode",e.submode));if(0===e.submode.length)return new TypeError(g("invalid option. `%s` option must be an array containing recognized modes. Option: `%s`.","submode",e.submode.join(",")));for(r=0;r<e.submode.length;r++)if(!j(e.submode[r]))return new TypeError(g("invalid option. Each submode must be a recognized mode. Option: `%s`.",e.submode[r]));e.submode=e.submode.slice()}return v(t,"readonly")&&(e.readonly=t.readonly,!y(e.readonly))?new TypeError(g("invalid option. `%s` option must be a boolean. Option: `%s`.","readonly",e.readonly)):null}var T=u.get("index_mode");function V(e,u,h,p,f,b,v){var c,j,y,w,_;if(!(this instanceof V))return arguments.length<7?new V(e,u,h,p,f,b):new V(e,u,h,p,f,b,v);if(!a(e))throw new TypeError(g("invalid argument. First argument must be a supported ndarray data type. Value: `%s`.",e));if(!t(u))throw new TypeError(g("invalid argument. Second argument must be an array-like object, typed-array-like, or a Buffer. Value: `%s`.",u));if(u.get&&u.set&&(!i(u.get)||!i(u.set)))throw new TypeError(g("invalid argument. Second argument `get` and `set` properties must be functions. Value: `%s`.",u));if(!r(h)&&(!t(h)||h.length>0))throw new TypeError(g("invalid argument. Third argument must be an array-like object containing nonnegative integers. Value: `%s`.",h));if((c=h.length)>32767)throw new RangeError(g("invalid argument. Number of dimensions must not exceed %u due to stack limits. Value: `%u`.",32767,c));if(!n(p))throw new TypeError(g("invalid argument. Fourth argument must be an array-like object containing integers. Value: `%s`.",p));if(c>0){if(p.length!==c)throw new RangeError(g("invalid argument. Fourth argument length must match the number of dimensions. Expected number of dimensions: `%u`. Strides length: `%u`.",c,p.length))}else{if(1!==p.length)throw new RangeError("invalid argument. Fourth argument length must be equal to 1 when creating a zero-dimensional ndarray.");if(0!==p[0])throw new RangeError(g("invalid argument. Fourth argument must contain a single element equal to 0. Value: `%d`.",p[0]))}if(!s(f))throw new TypeError(g("invalid argument. Fifth argument must be a nonnegative integer. Value: `%s`.",f));if(!o(b))throw new TypeError(g("invalid argument. Sixth argument must be a supported order. Value: `%s`.",b));if(c>0&&!d(u.length,h,p,f)&&m(h)>0)throw new Error("invalid arguments. Input buffer is incompatible with the specified meta data. Ensure that the offset is valid with regard to the strides array and that the buffer has enough elements to satisfy the desired array shape.");if((j={}).mode=T,j.readonly=false,arguments.length>6&&(y=x(j,v)))throw y;return this._mode=j.mode,void 0===j.submode&&(j.submode=[this._mode]),this._submode=j.submode,w=E(h,c),_=E(p,c||1),l.call(this,e,u,w,_,f,b),this._flags.READONLY=j.readonly,this}h(V,l),e(V,"name","ndarray"),e(V.prototype,"get",(function(){var e,t,r,s;if(arguments.length!==this._ndims)throw new RangeError(g("invalid arguments. Number of indices must match the number of dimensions. ndims: `%u`. nargs: `%u`.",this._ndims,arguments.length));for(e=this._offset,r=this._submode.length,s=0;s<arguments.length;s++){if(!p(arguments[s]))throw new TypeError(g("invalid argument. Indices must be integer valued. Argument: `%u`. Value: `%s`.",s,arguments[s]));t=f(arguments[s],this._shape[s]-1,this._submode[s%r]),e+=this._strides[s]*t}return this._accessors?this._buffer.get(e):this._buffer[e]})),e(V.prototype,"iget",(function(e){if(this._ndims>0){if(!p(e))throw new TypeError(g("invalid argument. Index must be an integer. Value: `%s`.",e));return e=f(e,this._length-1,this._mode),w.call(this,e)}return w.call(this)})),e(V.prototype,"set",(function(){var e,t,r,s;if(this._flags.READONLY)throw new Error("invalid invocation. Cannot write to a read-only array.");if(arguments.length!==this._ndims+1)throw new RangeError(g("invalid arguments. Number of indices must match the number of dimensions. ndims: `%u`. nargs: `%u`.",this._ndims,arguments.length));for(e=this._offset,r=this._submode.length,s=0;s<arguments.length-1;s++){if(!p(arguments[s]))throw new TypeError(g("invalid argument. Indices must be integer valued. Argument: `%i`. Value: `%s`.",s,arguments[s]));t=f(arguments[s],this._shape[s]-1,this._submode[s%r]),e+=this._strides[s]*t}return this._accessors?this._buffer.set(arguments[s],e):this._buffer[e]=arguments[s],this})),e(V.prototype,"iset",(function(e,t){if(this._flags.READONLY)throw new Error("invalid invocation. Cannot write to a read-only array.");if(this._ndims>0){if(!p(e))throw new TypeError(g("invalid argument. Index must be an integer. Value: `%s`.",e));e=f(e,this._length-1,this._mode),_.call(this,e,t)}else _.call(this,e);return this}));export{V as default};
//# sourceMappingURL=index.mjs.map
