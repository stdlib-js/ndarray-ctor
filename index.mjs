// Copyright (c) 2023 The Stdlib Authors. License is Apache-2.0: http://www.apache.org/licenses/LICENSE-2.0
/// <reference types="./index.d.ts" />
import e from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-define-nonenumerable-read-only-property@esm/index.mjs";import t from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-collection@esm/index.mjs";import{primitives as r}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer-array@esm/index.mjs";import{isPrimitive as s}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-nonnegative-integer@esm/index.mjs";import{primitives as i}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer-array@esm/index.mjs";import n from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-function@esm/index.mjs";import o from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-order@esm/index.mjs";import d from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-data-type@esm/index.mjs";import a from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-buffer-length-compatible@esm/index.mjs";import m from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-numel@esm/index.mjs";import h from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ctor@esm/index.mjs";import l from"https://cdn.jsdelivr.net/gh/stdlib-js/utils-inherit@esm/index.mjs";import u from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@v0.0.2-esm/index.mjs";import{isPrimitive as g}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-integer@esm/index.mjs";import p from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-ind@esm/index.mjs";import f from"https://cdn.jsdelivr.net/gh/stdlib-js/error-tools-fmtprodmsg@esm/index.mjs";import b from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-plain-object@esm/index.mjs";import c from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-has-own-property@esm/index.mjs";import j from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-array@esm/index.mjs";import v from"https://cdn.jsdelivr.net/gh/stdlib-js/ndarray-base-assert-is-index-mode@esm/index.mjs";import{isPrimitive as y}from"https://cdn.jsdelivr.net/gh/stdlib-js/assert-is-boolean@esm/index.mjs";var w="throw",E=!1,_=h.prototype.iget;var x=h.prototype.iset;function T(e,t){var r,s;for(r=[],s=0;s<t;s++)r.push(e[s]);return r}function V(e,t){var r;if(!b(t))return new TypeError(f("0Mp2h",t));if(c(t,"mode")&&(e.mode=t.mode,!v(e.mode)))return new TypeError(f("0Mp5o","mode",e.mode));if(c(t,"submode")){if(e.submode=t.submode,!j(e.submode))return new TypeError(f("0Mp5p","submode",e.submode));if(0===e.submode.length)return new TypeError(f("0Mp5p","submode",e.submode.join(",")));for(r=0;r<e.submode.length;r++)if(!v(e.submode[r]))return new TypeError(f("invalid option. Each submode must be a recognized mode. Option: `%s`.",e.submode[r]));e.submode=e.submode.slice()}return c(t,"readonly")&&(e.readonly=t.readonly,!y(e.readonly))?new TypeError(f("0Mp30","readonly",e.readonly)):null}function R(e,l,g,p,f,b,c){var j,v,y,_,x;if(!(this instanceof R))return arguments.length<7?new R(e,l,g,p,f,b):new R(e,l,g,p,f,b,c);if(!d(e))throw new TypeError(u("invalid argument. First argument must be a supported ndarray data type. Value: `%s`.",e));if(!t(l))throw new TypeError(u("invalid argument. Second argument must be an array-like object, typed-array-like, or a Buffer. Value: `%s`.",l));if(l.get&&l.set&&(!n(l.get)||!n(l.set)))throw new TypeError(u("invalid argument. Second argument `get` and `set` properties must be functions. Value: `%s`.",l));if(!r(g)&&(!t(g)||g.length>0))throw new TypeError(u("invalid argument. Third argument must be an array-like object containing nonnegative integers. Value: `%s`.",g));if((j=g.length)>32767)throw new RangeError(u("invalid argument. Number of dimensions must not exceed %u due to stack limits. Value: `%u`.",32767,j));if(!i(p))throw new TypeError(u("invalid argument. Fourth argument must be an array-like object containing integers. Value: `%s`.",p));if(j>0){if(p.length!==j)throw new RangeError(u("invalid argument. Fourth argument length must match the number of dimensions. Expected number of dimensions: `%u`. Strides length: `%u`.",j,p.length))}else{if(1!==p.length)throw new RangeError("invalid argument. Fourth argument length must be equal to 1 when creating a zero-dimensional ndarray.");if(0!==p[0])throw new RangeError(u("invalid argument. Fourth argument must contain a single element equal to 0. Value: `%d`.",p[0]))}if(!s(f))throw new TypeError(u("0Mp5v",f));if(!o(b))throw new TypeError(u("invalid argument. Sixth argument must be a supported order. Value: `%s`.",b));if(j>0&&!a(l.length,g,p,f)&&m(g)>0)throw new Error("invalid arguments. Input buffer is incompatible with the specified meta data. Ensure that the offset is valid with regard to the strides array and that the buffer has enough elements to satisfy the desired array shape.");if((v={}).mode=w,v.readonly=E,arguments.length>6&&(y=V(v,c)))throw y;return this._mode=v.mode,void 0===v.submode&&(v.submode=[this._mode]),this._submode=v.submode,_=T(g,j),x=T(p,j||1),h.call(this,e,l,_,x,f,b),this._flags.READONLY=v.readonly,this}l(R,h),e(R,"name","ndarray"),e(R.prototype,"get",(function(){var e,t,r,s;if(arguments.length!==this._ndims)throw new RangeError(f("invalid arguments. Number of indices must match the number of dimensions. ndims: `%u`. nargs: `%u`.",this._ndims,arguments.length));for(e=this._offset,r=this._submode.length,s=0;s<arguments.length;s++){if(!g(arguments[s]))throw new TypeError(f("invalid argument. Indices must be integer valued. Argument: `%u`. Value: `%s`.",s,arguments[s]));t=p(arguments[s],this._shape[s]-1,this._submode[s%r]),e+=this._strides[s]*t}return this._accessors?this._buffer.get(e):this._buffer[e]})),e(R.prototype,"iget",(function(e){if(this._ndims>0){if(!g(e))throw new TypeError(f("invalid argument. Index must be an integer. Value: `%s`.",e));return e=p(e,this._length-1,this._mode),_.call(this,e)}return _.call(this)})),e(R.prototype,"set",(function(){var e,t,r,s;if(this._flags.READONLY)throw new Error(f("0Mp0e"));if(arguments.length!==this._ndims+1)throw new RangeError(f("invalid arguments. Number of indices must match the number of dimensions. ndims: `%u`. nargs: `%u`.",this._ndims,arguments.length));for(e=this._offset,r=this._submode.length,s=0;s<arguments.length-1;s++){if(!g(arguments[s]))throw new TypeError(f("invalid argument. Indices must be integer valued. Argument: `%i`. Value: `%s`.",s,arguments[s]));t=p(arguments[s],this._shape[s]-1,this._submode[s%r]),e+=this._strides[s]*t}return this._accessors?this._buffer.set(arguments[s],e):this._buffer[e]=arguments[s],this})),e(R.prototype,"iset",(function(e,t){if(this._flags.READONLY)throw new Error(f("0Mp0e"));if(this._ndims>0){if(!g(e))throw new TypeError(f("invalid argument. Index must be an integer. Value: `%s`.",e));e=p(e,this._length-1,this._mode),x.call(this,e,t)}else x.call(this,e);return this}));export{R as default};
//# sourceMappingURL=index.mjs.map
